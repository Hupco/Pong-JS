<!Doctype html!>
<html lang="pl">
<head>
<meta charset="utf-8">
<title>Pong JS dla 2</title>
</head>
<body>
<style>

	html { 
	background: url(mortal.jpg) no-repeat center center fixed; 
	webkit-background-size: cover;
	-moz-background-size: cover;
	-o-background-size: cover;
	background-size: cover;
	}
	body{
		margin:0;
		padding:0;
		height:100vh;
		
	
	
	}
	

	canvas{
		display:block;
		margin: auto;
		border: solid 2px white;
	
	}

	h1,h2{
	text-align:center;
	display:block;
	margin: auto;
	color:blue;
	text-shadow: 2px 2px white;
	}

	h2{
	color:red;
	text-shadow: 2px 2px white;
	font-size:40px;
	}

</style>
<h1>Pong dla 2 graczy</h1>
<h1>Liczba punktów</h1>
<h2 id="pkt">0||0</h2>
<canvas></canvas>
<center>
<audio id="audio" autoplay controls loop>
  <source src="The Immortals Techno Syndrome.mp3" type="audio/mpeg">
Your browser does not support the audio element.
</audio>
</center>
<script>
	//The Immortals Techno Syndrome
	//audio
	var punch = new Audio();
	punch.src = "PUNCH.mp3"
	
	
	
	//punkty
	let pkl = 0;
	let pkr = 0;
	let punkty=document.getElementById("pkt")
	
	const canvas = document.querySelector('canvas');
	const ctx = canvas.getContext('2d');
	//rozmaiaryry pola
	canvas.width = 1000;
	canvas.height = 500;
	
	const canszer = canvas.width;
	const canwys = canvas.height; 
	const ballS=20;//srednica pilki(wysokosc , szerokosc);
	//Polozenie startowe
	let bX = canszer/2-ballS/2;
	let bY = canwys/2-ballS/2;
	//rozmiar paleczki 
	const paleczkaWys = 100;
	const paleczkaSzer = 20;
	//polozenie paleczek (na osi x)
	const graczX = 70;
	const botX= 910; 
	//polozenie paleczek (na osi y)
	let graczY = 200;
	let botY= 200; 
	//rozmiar kresek podzialu
	const kreskiWidth = 6;
	const kreskiHeight = 16;
	
	let ballVX = Math.floor(Math.random() * 2 -1);
	let ballVY = Math.floor(Math.random() * 2 -1);
	if(ballVX==0){ballVX+=1;}
	if(ballVY==0){ballVY+=1;}
	/*
	 function playAudio(){
	mkx.play();
	}
	playAudio();
	*/
	function gracz(){
	ctx.fillStyle="red";
	ctx.fillRect(graczX,graczY,paleczkaSzer,paleczkaWys);

	}
	function bot(){
	ctx.fillStyle='#0000ff';
	ctx.fillRect(botX,botY,paleczkaSzer,paleczkaWys);

	}
	
	
	function ball(){
	ctx.fillStyle="white";
	ctx.fillRect(bX,bY,ballS,ballS);
	
	
	bX+=ballVX;
	bY+=ballVY;
	
		//odbicie gora i dol
		if(bY<=0 || bY +ballS>=canwys){
		ballVY=-ballVY;
		acceleration()
		}
		//odbicie od paletek
		if((bX<=90 && bY>=graczY && bY<=graczY+paleczkaWys)  || (bX +ballS>=canszer-90 && bY>=botY && bY<=botY+paleczkaWys)){
		punch.play();
		ballVX=-ballVX;
		acceleration()
		}else if(bX<graczX){
				pkr+=1;
				punkty.innerText=pkl+"||"+pkr;
				bX=canszer/2-ballS/2;
				bY=canwys/2-ballS/2;
				ballVX=1;
				ballVY=1;
				
				}else if(bX +ballS>botX){
						pkl+=1;
						punkty.innerText=pkl+"||"+pkr;
						bX=canszer/2-ballS/2;
						bY=canwys/2-ballS/2;
						ballVX=1;
						ballVY=1;
						}

	}
	
	function table(){
		//Stół
		ctx.fillStyle = 'black'; //zmiana koloru
		ctx.fillRect(0,0,canszer,canwys);  // wypełneinie przestrzenią (x0,y0,xk,yk)
		
	
		for(let lp = 20;lp<canwys;lp+=30){ //kreski podzialu (lp-pozycja lini)
		ctx.fillStyle = "gray";
		ctx.fillRect(canszer/2-kreskiWidth/2,lp,kreskiWidth,kreskiHeight);
	
		}
	
		
	}
	
	topCanvas= canvas.offsetTop; //odleglosc canvasa od gory strony
	console.log(topCanvas)
	
	function pozycjaGracza(p){
	//console.log("pozycja myszy"+(p.clientY-topCanvas)+"||"+(p.clientY))
	graczY = p.clientY-topCanvas -paleczkaWys/2;
	
	//ograniczenia
	if(graczY>=canwys-paleczkaWys){
		graczY=canwys -paleczkaWys;
		}
	if(graczY<=0){
		graczY=0;
		}

	//botY=graczY //TEST
	
	}
	//2 gracz
	
	function pozycjaBota(e){
	console.log(e.keyCode);
	
		switch(e.keyCode){
		
		case 38: if(botY<=0){
			botY=0;
		}else botY-=25
		break;
	
		case 40: if(botY>=canwys-paleczkaWys){
					botY=canwys -paleczkaWys;
		}else botY+=25
		break;
		}
	
	
	}
	
	function acceleration(){
		//console.log("przyspiesza" + "||"+Math.abs(ballVX))
		if(ballVX > 0 && ballVX <8){
		ballVX +=0.4;
		}
		else if(ballVX < 0 && ballVX >-8){
			ballVX -=0.4;
			}
		if(ballVY > 0 && ballVY <8){
		ballVY +=0.4;
		}
		else if(ballVY < 0 && ballVY >-8){
			ballVY -=0.4;
			}
		
		
	}
	
	
	
	
	
	//nasluchiwanie zdarzenia (ruchu myszką)
	canvas.addEventListener("mousemove",pozycjaGracza)
	//ruch klawiszami
	window.addEventListener("keydown",pozycjaBota)
	function rysuj(){
	table(); //zamalowywuje  na czrno
	ball(); //tworzy pilke
	gracz();//gracza
	bot();// i bota
	//pozycjaBota();
	
	}
	setInterval(rysuj,1000/60) //60 klatek na sekunde
	
	</script>

</body>
</html>

